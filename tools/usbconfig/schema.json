{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/definitions/UsbConfig",
    "definitions": {
        "UsbConfig": {
            "title": "USB Configuration",
            "description": "",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "devices": {
                    "$ref": "#/definitions/Devices"
                },
                "host": {
                    "title": "Host Interfaces",
                    "description": "Number of interfaces of each class required",
                    "type": "object",
                    "$ref": "#/definitions/HostInterface"
                }
            }
        },
        "HostInterface": {
            "title": "Host Interface definition",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "hid": {
                    "type": "integer",
                    "min": 0
                },
                "cdc": {
                    "type": "integer",
                    "min": 0
                },
                "msc": {
                    "type": "integer",
                    "min": 0
                },
                "vendor": {
                    "type": "integer",
                    "min": 0
                }
            }
        },
        "Devices": {
            "title": "Devices",
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
                "^[A-Za-z_][A-Za-z0-9_]*$": {
                    "type": "object",
                    "$ref": "#/definitions/Device"
                }
            }
        },
        "Device": {
            "title": "Device",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "class": {
                    "type": "string"
                },
                "subclass": {
                    "type": "string"
                },
                "protocol": {
                    "type": "string"
                },
                "vendor_id": {
                    "type": "string"
                },
                "product_id": {
                    "type": "string"
                },
                "version": {
                    "type": "string"
                },
                "manufacturer": {
                    "type": "string"
                },
                "product": {
                    "type": "string"
                },
                "serial": {
                    "type": "string",
                    "format": "integer"
                },
                "configs": {
                    "$ref": "#/definitions/Configs"
                }
            },
            "required": [
                "class",
                "configs",
                "manufacturer",
                "product",
                "product_id",
                "protocol",
                "serial",
                "subclass",
                "vendor_id",
                "version"
            ]
        },
        "Configs": {
            "title": "Configs",
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
                "^[A-Za-z_][A-Za-z0-9_]*$": {
                    "type": "object",
                    "$ref": "#/definitions/Config"
                }
            }
        },
        "Config": {
            "title": "Config",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "description": {
                    "type": "string"
                },
                "attributes": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "power": {
                    "type": "integer"
                },
                "interfaces": {
                    "$ref": "#/definitions/Interfaces"
                }
            },
            "required": [
                "attributes",
                "description",
                "interfaces",
                "power"
            ]
        },
        "Interfaces": {
            "title": "Interfaces",
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
                "^[A-Za-z_][A-Za-z0-9_]*$": {
                    "anyOf": [
                        {
                            "type": "object",
                            "$ref": "#/definitions/HID"
                        },
                        {
                            "type": "object",
                            "$ref": "#/definitions/CDC"
                        },
                        {
                            "type": "object",
                            "$ref": "#/definitions/MSC"
                        },
                        {
                            "type": "object",
                            "$ref": "#/definitions/MIDI"
                        },
                        {
                            "type": "object",
                            "$ref": "#/definitions/DFU"
                        }
                    ]
                }
            }
        },
        "CDC": {
            "title": "CDC",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "description": {
                    "type": "string"
                },
                "template": {
                    "enum": [
                        "cdc"
                    ]
                }
            },
            "required": [
                "description",
                "template"
            ]
        },
        "DFU": {
            "title": "DFU",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "template": {
                    "enum": [
                        "dfu"
                    ]
                },
                "alternates": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            },
            "required": [
                "alternates",
                "template"
            ]
        },
        "HID": {
            "title": "HID",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "description": {
                    "type": "string"
                },
                "template": {
                    "enum": [
                        "hid"
                    ]
                },
                "protocol": {
                    "type": "string"
                },
                "bufsize": {
                    "type": "integer",
                    "minimum": 4,
                    "maximum": 512
                },
                "poll-interval": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 255
                },
                "reports": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            },
            "required": [
                "bufsize",
                "description",
                "poll-interval",
                "protocol",
                "reports",
                "template"
            ]
        },
        "MIDI": {
            "title": "MIDI",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "description": {
                    "type": "string"
                },
                "template": {
                    "enum": [
                        "midi"
                    ]
                }
            },
            "required": [
                "description",
                "template"
            ]
        },
        "MSC": {
            "title": "MSC",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "description": {
                    "type": "string"
                },
                "template": {
                    "enum": [
                        "msc"
                    ]
                },
                "vendor": {
                    "type": "string"
                },
                "product": {
                    "type": "string"
                },
                "version": {
                    "type": "string",
                    "format": "integer"
                }
            },
            "required": [
                "description",
                "product",
                "template",
                "vendor",
                "version"
            ]
        }
    }
}